describe('Linechart', () => {
  beforeEach(() => {
    //Append default chart div
    var div = document.createElement('div');
    div.innerHTML = '<div id="chart"></div>';
    document.body.appendChild(div);
  });

  afterEach(() => {
    //Remove default chart div
    var el = document.getElementById('chart');
    el.parentNode.removeChild(el);
  });

  describe('constructor()', () => {
    it('throws a "Missing constructor parameters" if the data parameter is missing', () => {
      assert.throws(() => {
        new Linechart()
      }, Error, 'Missing constructor parameters');
    });

    it('will construct a line chart given some data', () => {
      var data = [{ x: 0, y: 1 }, { x: 0, y: 2 }];
      var chart = new Linechart(data);
      assert.isOk(chart);
    });

    it('throws a "Wrong data format" TypeError if data is not an object neither an array', () => {
      var data = 'wrong parameter';
      assert.throws(() => {
        new Linechart(data)
      }, TypeError, 'Wrong data format');
    });

  });

  describe('chart functions', () => {
    it('toPNG()', (done) => {
      var data = [{ x: 0, y: 1 }, { x: 1, y: 2 }];
      var chart = new Linechart(data);
      chart.draw();
      //wait for image creation
      setTimeout(() => {
        var result = chart.toPNG((uri) => {

          assert.equal(uri, 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB3aWR0aD0iNjcwIiBoZWlnaHQ9IjMyMCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2aWV3Qm94PSIwIDAgNjcwIDMyMCI+PGRlZnM+PHN0eWxlIHR5cGU9InRleHQvY3NzIj48IVtDREFUQVsKCl1dPjwvc3R5bGU+PC9kZWZzPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDUwLDIwKSI+PHBhdGggZD0iTTAsMTI1TDYwMCwwIiBzdHlsZT0ic3Ryb2tlOiBzdGVlbGJsdWU7IHN0cm9rZS13aWR0aDogMjsgZmlsbDogbm9uZTsiPjwvcGF0aD48ZyBjbGFzcz0ieCBheGlzIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLDI1MCkiIHN0eWxlPSJmb250LXN0eWxlOiBub3JtYWw7IGZvbnQtdmFyaWFudDogbm9ybWFsOyBmb250LXdlaWdodDogbm9ybWFsOyBmb250LXN0cmV0Y2g6IG5vcm1hbDsgZm9udC1zaXplOiAxMHB4OyBsaW5lLWhlaWdodDogbm9ybWFsOyBmb250LWZhbWlseTogc2Fucy1zZXJpZjsiPjxnIGNsYXNzPSJ0aWNrIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLDApIiBzdHlsZT0ib3BhY2l0eTogMTsiPjxsaW5lIHkyPSI2IiB4Mj0iMCIgc3R5bGU9ImZpbGw6IG5vbmU7IHN0cm9rZTogcmdiKDAsIDAsIDApOyI+PC9saW5lPjx0ZXh0IGR5PSIuNzFlbSIgeT0iOSIgeD0iMCIgc3R5bGU9InRleHQtYW5jaG9yOiBtaWRkbGU7Ij4wLjA8L3RleHQ+PC9nPjxnIGNsYXNzPSJ0aWNrIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg2MCwwKSIgc3R5bGU9Im9wYWNpdHk6IDE7Ij48bGluZSB5Mj0iNiIgeDI9IjAiIHN0eWxlPSJmaWxsOiBub25lOyBzdHJva2U6IHJnYigwLCAwLCAwKTsiPjwvbGluZT48dGV4dCBkeT0iLjcxZW0iIHk9IjkiIHg9IjAiIHN0eWxlPSJ0ZXh0LWFuY2hvcjogbWlkZGxlOyI+MC4xPC90ZXh0PjwvZz48ZyBjbGFzcz0idGljayIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTIwLDApIiBzdHlsZT0ib3BhY2l0eTogMTsiPjxsaW5lIHkyPSI2IiB4Mj0iMCIgc3R5bGU9ImZpbGw6IG5vbmU7IHN0cm9rZTogcmdiKDAsIDAsIDApOyI+PC9saW5lPjx0ZXh0IGR5PSIuNzFlbSIgeT0iOSIgeD0iMCIgc3R5bGU9InRleHQtYW5jaG9yOiBtaWRkbGU7Ij4wLjI8L3RleHQ+PC9nPjxnIGNsYXNzPSJ0aWNrIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxODAsMCkiIHN0eWxlPSJvcGFjaXR5OiAxOyI+PGxpbmUgeTI9IjYiIHgyPSIwIiBzdHlsZT0iZmlsbDogbm9uZTsgc3Ryb2tlOiByZ2IoMCwgMCwgMCk7Ij48L2xpbmU+PHRleHQgZHk9Ii43MWVtIiB5PSI5IiB4PSIwIiBzdHlsZT0idGV4dC1hbmNob3I6IG1pZGRsZTsiPjAuMzwvdGV4dD48L2c+PGcgY2xhc3M9InRpY2siIHRyYW5zZm9ybT0idHJhbnNsYXRlKDI0MCwwKSIgc3R5bGU9Im9wYWNpdHk6IDE7Ij48bGluZSB5Mj0iNiIgeDI9IjAiIHN0eWxlPSJmaWxsOiBub25lOyBzdHJva2U6IHJnYigwLCAwLCAwKTsiPjwvbGluZT48dGV4dCBkeT0iLjcxZW0iIHk9IjkiIHg9IjAiIHN0eWxlPSJ0ZXh0LWFuY2hvcjogbWlkZGxlOyI+MC40PC90ZXh0PjwvZz48ZyBjbGFzcz0idGljayIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzAwLDApIiBzdHlsZT0ib3BhY2l0eTogMTsiPjxsaW5lIHkyPSI2IiB4Mj0iMCIgc3R5bGU9ImZpbGw6IG5vbmU7IHN0cm9rZTogcmdiKDAsIDAsIDApOyI+PC9saW5lPjx0ZXh0IGR5PSIuNzFlbSIgeT0iOSIgeD0iMCIgc3R5bGU9InRleHQtYW5jaG9yOiBtaWRkbGU7Ij4wLjU8L3RleHQ+PC9nPjxnIGNsYXNzPSJ0aWNrIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzNjAsMCkiIHN0eWxlPSJvcGFjaXR5OiAxOyI+PGxpbmUgeTI9IjYiIHgyPSIwIiBzdHlsZT0iZmlsbDogbm9uZTsgc3Ryb2tlOiByZ2IoMCwgMCwgMCk7Ij48L2xpbmU+PHRleHQgZHk9Ii43MWVtIiB5PSI5IiB4PSIwIiBzdHlsZT0idGV4dC1hbmNob3I6IG1pZGRsZTsiPjAuNjwvdGV4dD48L2c+PGcgY2xhc3M9InRpY2siIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQyMCwwKSIgc3R5bGU9Im9wYWNpdHk6IDE7Ij48bGluZSB5Mj0iNiIgeDI9IjAiIHN0eWxlPSJmaWxsOiBub25lOyBzdHJva2U6IHJnYigwLCAwLCAwKTsiPjwvbGluZT48dGV4dCBkeT0iLjcxZW0iIHk9IjkiIHg9IjAiIHN0eWxlPSJ0ZXh0LWFuY2hvcjogbWlkZGxlOyI+MC43PC90ZXh0PjwvZz48ZyBjbGFzcz0idGljayIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNDgwLDApIiBzdHlsZT0ib3BhY2l0eTogMTsiPjxsaW5lIHkyPSI2IiB4Mj0iMCIgc3R5bGU9ImZpbGw6IG5vbmU7IHN0cm9rZTogcmdiKDAsIDAsIDApOyI+PC9saW5lPjx0ZXh0IGR5PSIuNzFlbSIgeT0iOSIgeD0iMCIgc3R5bGU9InRleHQtYW5jaG9yOiBtaWRkbGU7Ij4wLjg8L3RleHQ+PC9nPjxnIGNsYXNzPSJ0aWNrIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1NDAsMCkiIHN0eWxlPSJvcGFjaXR5OiAxOyI+PGxpbmUgeTI9IjYiIHgyPSIwIiBzdHlsZT0iZmlsbDogbm9uZTsgc3Ryb2tlOiByZ2IoMCwgMCwgMCk7Ij48L2xpbmU+PHRleHQgZHk9Ii43MWVtIiB5PSI5IiB4PSIwIiBzdHlsZT0idGV4dC1hbmNob3I6IG1pZGRsZTsiPjAuOTwvdGV4dD48L2c+PGcgY2xhc3M9InRpY2siIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYwMCwwKSIgc3R5bGU9Im9wYWNpdHk6IDE7Ij48bGluZSB5Mj0iNiIgeDI9IjAiIHN0eWxlPSJmaWxsOiBub25lOyBzdHJva2U6IHJnYigwLCAwLCAwKTsiPjwvbGluZT48dGV4dCBkeT0iLjcxZW0iIHk9IjkiIHg9IjAiIHN0eWxlPSJ0ZXh0LWFuY2hvcjogbWlkZGxlOyI+MS4wPC90ZXh0PjwvZz48cGF0aCBjbGFzcz0iZG9tYWluIiBkPSJNMCw2VjBINjAwVjYiIHN0eWxlPSJzdHJva2U6IHJnYigwLCAwLCAwKTsgc3Ryb2tlLXdpZHRoOiAyOyBmaWxsOiBub25lOyBkaXNwbGF5OiBub25lOyI+PC9wYXRoPjwvZz48ZyBjbGFzcz0ieSBheGlzIiBzdHJva2UtZGFzaGFycmF5PSI1LCA1IiBzdHlsZT0iZm9udC1zdHlsZTogbm9ybWFsOyBmb250LXZhcmlhbnQ6IG5vcm1hbDsgZm9udC13ZWlnaHQ6IG5vcm1hbDsgZm9udC1zdHJldGNoOiBub3JtYWw7IGZvbnQtc2l6ZTogMTBweDsgbGluZS1oZWlnaHQ6IG5vcm1hbDsgZm9udC1mYW1pbHk6IHNhbnMtc2VyaWY7Ij48ZyBjbGFzcz0idGljayIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCwyNTApIiBzdHlsZT0ib3BhY2l0eTogMTsiPjxsaW5lIHgyPSI2MDAiIHkyPSIwIiBzdHlsZT0iZmlsbDogbm9uZTsgc3Ryb2tlOiByZ2IoMCwgMCwgMCk7Ij48L2xpbmU+PHRleHQgZHk9Ii4zMmVtIiB4PSItMjAiIHk9IjAiIHN0eWxlPSJ0ZXh0LWFuY2hvcjogZW5kOyI+MC4wPC90ZXh0PjwvZz48ZyBjbGFzcz0idGljayIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCwxODcuNSkiIHN0eWxlPSJvcGFjaXR5OiAxOyI+PGxpbmUgeDI9IjYwMCIgeTI9IjAiIHN0eWxlPSJmaWxsOiBub25lOyBzdHJva2U6IHJnYigwLCAwLCAwKTsiPjwvbGluZT48dGV4dCBkeT0iLjMyZW0iIHg9Ii0yMCIgeT0iMCIgc3R5bGU9InRleHQtYW5jaG9yOiBlbmQ7Ij4wLjU8L3RleHQ+PC9nPjxnIGNsYXNzPSJ0aWNrIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLDEyNSkiIHN0eWxlPSJvcGFjaXR5OiAxOyI+PGxpbmUgeDI9IjYwMCIgeTI9IjAiIHN0eWxlPSJmaWxsOiBub25lOyBzdHJva2U6IHJnYigwLCAwLCAwKTsiPjwvbGluZT48dGV4dCBkeT0iLjMyZW0iIHg9Ii0yMCIgeT0iMCIgc3R5bGU9InRleHQtYW5jaG9yOiBlbmQ7Ij4xLjA8L3RleHQ+PC9nPjxnIGNsYXNzPSJ0aWNrIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLDYyLjUpIiBzdHlsZT0ib3BhY2l0eTogMTsiPjxsaW5lIHgyPSI2MDAiIHkyPSIwIiBzdHlsZT0iZmlsbDogbm9uZTsgc3Ryb2tlOiByZ2IoMCwgMCwgMCk7Ij48L2xpbmU+PHRleHQgZHk9Ii4zMmVtIiB4PSItMjAiIHk9IjAiIHN0eWxlPSJ0ZXh0LWFuY2hvcjogZW5kOyI+MS41PC90ZXh0PjwvZz48ZyBjbGFzcz0idGljayIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCwwKSIgc3R5bGU9Im9wYWNpdHk6IDE7Ij48bGluZSB4Mj0iNjAwIiB5Mj0iMCIgc3R5bGU9ImZpbGw6IG5vbmU7IHN0cm9rZTogcmdiKDAsIDAsIDApOyI+PC9saW5lPjx0ZXh0IGR5PSIuMzJlbSIgeD0iLTIwIiB5PSIwIiBzdHlsZT0idGV4dC1hbmNob3I6IGVuZDsiPjIuMDwvdGV4dD48L2c+PHBhdGggY2xhc3M9ImRvbWFpbiIgZD0iTTAsMEgwVjI1MEgwIiBzdHlsZT0ic3Ryb2tlOiByZ2IoMCwgMCwgMCk7IHN0cm9rZS13aWR0aDogMjsgZmlsbDogbm9uZTsiPjwvcGF0aD48dGV4dD48L3RleHQ+PC9nPjwvZz48L3N2Zz4=');
        });
        done();
      }, 1200);
    });
  });
});